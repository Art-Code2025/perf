<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯ - GHEM Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .test-result {
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border: 1px solid;
        }
        .test-success {
            background-color: #f0f9ff;
            border-color: #22c55e;
            color: #15803d;
        }
        .test-error {
            background-color: #fef2f2;
            border-color: #ef4444;
            color: #dc2626;
        }
        .test-warning {
            background-color: #fffbeb;
            border-color: #f59e0b;
            color: #d97706;
        }
        .test-info {
            background-color: #f8fafc;
            border-color: #64748b;
            color: #475569;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="container mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">ğŸ” ØªØ´Ø®ÙŠØµ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯</h1>
            
            <!-- Test Controls -->
            <div class="mb-8 text-center">
                <button onclick="runAllTests()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors mr-4">
                    ğŸš€ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                </button>
                <button onclick="clearResults()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors">
                    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                </button>
            </div>

            <!-- Results Container -->
            <div id="results" class="space-y-4">
                <!-- Results will be populated here -->
            </div>

            <!-- Manual Tests -->
            <div class="mt-12 bg-gray-100 rounded-lg p-6">
                <h2 class="text-xl font-bold mb-4">ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙŠØ¯ÙˆÙŠØ©</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <button onclick="testLogin()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                        ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                    <button onclick="testDashboardAccess()" class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">
                        ğŸ“Š Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯
                    </button>
                    <button onclick="testProductsAPI()" class="bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700">
                        ğŸ“¦ Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    </button>
                    <button onclick="testCategoriesAPI()" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">
                        ğŸ“‚ Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª
                    </button>
                    <button onclick="testCouponsAPI()" class="bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700">
                        ğŸ« Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª
                    </button>
                    <button onclick="testOrdersAPI()" class="bg-teal-600 text-white px-4 py-2 rounded hover:bg-teal-700">
                        ğŸ›’ Ø§Ø®ØªØ¨Ø§Ø± API Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                    </button>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="mt-8 bg-blue-50 rounded-lg p-6">
                <h2 class="text-xl font-bold mb-4">ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <a href="http://localhost:5173" target="_blank" class="bg-blue-600 text-white px-4 py-2 rounded text-center hover:bg-blue-700">
                        ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                    <a href="http://localhost:5173/login" target="_blank" class="bg-green-600 text-white px-4 py-2 rounded text-center hover:bg-green-700">
                        ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </a>
                    <a href="http://localhost:5173/admin" target="_blank" class="bg-purple-600 text-white px-4 py-2 rounded text-center hover:bg-purple-700">
                        ğŸ“Š Ø§Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯
                    </a>
                    <a href="http://localhost:3001/api/health" target="_blank" class="bg-red-600 text-white px-4 py-2 rounded text-center hover:bg-red-700">
                        â¤ï¸ ØµØ­Ø© Ø§Ù„Ø®Ø§Ø¯Ù…
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api';
        
        function addResult(title, status, message, details = null) {
            const results = document.getElementById('results');
            const resultDiv = document.createElement('div');
            
            let statusClass = 'test-info';
            let statusIcon = 'â„¹ï¸';
            
            switch(status) {
                case 'success':
                    statusClass = 'test-success';
                    statusIcon = 'âœ…';
                    break;
                case 'error':
                    statusClass = 'test-error';
                    statusIcon = 'âŒ';
                    break;
                case 'warning':
                    statusClass = 'test-warning';
                    statusIcon = 'âš ï¸';
                    break;
            }
            
            resultDiv.className = `test-result ${statusClass}`;
            resultDiv.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <h3 class="font-bold">${statusIcon} ${title}</h3>
                        <p class="mt-1">${message}</p>
                        ${details ? `<pre class="mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto">${details}</pre>` : ''}
                    </div>
                    <span class="text-xs opacity-75">${new Date().toLocaleTimeString('ar-SA')}</span>
                </div>
            `;
            
            results.appendChild(resultDiv);
            results.scrollTop = results.scrollHeight;
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
        
        async function testServerConnection() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…', 'success', 'Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø®Ù„ÙÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ', JSON.stringify(data, null, 2));
                } else {
                    addResult('Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…', 'error', `ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: ${response.status} ${response.statusText}`);
                }
            } catch (error) {
                addResult('Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…', 'error', 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø®Ù„ÙÙŠ', error.message);
            }
        }
        
        async function testDatabaseConnection() {
            try {
                const response = await fetch(`${API_BASE}/categories`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success', `ØªÙ… Ø¬Ù„Ø¨ ${data.length} ØªØµÙ†ÙŠÙ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`);
                } else {
                    addResult('Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error', `ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${response.status}`);
                }
            } catch (error) {
                addResult('Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error', 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', error.message);
            }
        }
        
        async function testAuthentication() {
            const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';
            if (isAuthenticated) {
                addResult('Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©', 'success', 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„');
            } else {
                addResult('Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©', 'warning', 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ - Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
            }
        }
        
        async function testProductsAPI() {
            try {
                const response = await fetch(`${API_BASE}/products`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', 'success', `ØªÙ… Ø¬Ù„Ø¨ ${data.length} Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­`);
                    
                    // Test product details
                    if (data.length > 0) {
                        const firstProduct = data[0];
                        addResult('ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬', 'info', `Ø£ÙˆÙ„ Ù…Ù†ØªØ¬: ${firstProduct.name}`, JSON.stringify(firstProduct, null, 2));
                    }
                } else {
                    addResult('API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', 'error', `ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${response.status}`);
                }
            } catch (error) {
                addResult('API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', 'error', 'Ø®Ø·Ø£ ÙÙŠ API Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª', error.message);
            }
        }
        
        async function testCategoriesAPI() {
            try {
                const response = await fetch(`${API_BASE}/categories`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('API Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª', 'success', `ØªÙ… Ø¬Ù„Ø¨ ${data.length} ØªØµÙ†ÙŠÙ Ø¨Ù†Ø¬Ø§Ø­`);
                    
                    if (data.length > 0) {
                        const firstCategory = data[0];
                        addResult('ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙ', 'info', `Ø£ÙˆÙ„ ØªØµÙ†ÙŠÙ: ${firstCategory.name}`, JSON.stringify(firstCategory, null, 2));
                    }
                } else {
                    addResult('API Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª', 'error', `ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª: ${response.status}`);
                }
            } catch (error) {
                addResult('API Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª', 'error', 'Ø®Ø·Ø£ ÙÙŠ API Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª', error.message);
            }
        }
        
        async function testCouponsAPI() {
            try {
                const response = await fetch(`${API_BASE}/coupons`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('API Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª', 'success', `ØªÙ… Ø¬Ù„Ø¨ ${data.length} ÙƒÙˆØ¨ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­`);
                } else {
                    addResult('API Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª', 'error', `ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª: ${response.status}`);
                }
            } catch (error) {
                addResult('API Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª', 'error', 'Ø®Ø·Ø£ ÙÙŠ API Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª', error.message);
            }
        }
        
        async function testOrdersAPI() {
            try {
                const response = await fetch(`${API_BASE}/orders`);
                if (response.ok) {
                    const data = await response.json();
                    addResult('API Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'success', `ØªÙ… Ø¬Ù„Ø¨ ${data.length} Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­`);
                } else {
                    addResult('API Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'error', `ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${response.status}`);
                }
            } catch (error) {
                addResult('API Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'error', 'Ø®Ø·Ø£ ÙÙŠ API Ø§Ù„Ø·Ù„Ø¨Ø§Øª', error.message);
            }
        }
        
        function testLogin() {
            // Simulate login
            localStorage.setItem('isAuthenticated', 'true');
            addResult('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', 'success', 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ø§ÙƒØ§Ø©)');
        }
        
        function testDashboardAccess() {
            const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';
            if (isAuthenticated) {
                window.open('http://localhost:5173/admin', '_blank');
                addResult('Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯', 'success', 'ØªÙ… ÙØªØ­ Ø§Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©');
            } else {
                addResult('Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯', 'warning', 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
            }
        }
        
        async function testFrontendConnection() {
            try {
                const response = await fetch('http://localhost:5173');
                if (response.ok) {
                    addResult('Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©', 'success', 'Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ© ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 5173');
                } else {
                    addResult('Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©', 'error', `Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©: ${response.status}`);
                }
            } catch (error) {
                addResult('Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©', 'error', 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©', error.message);
            }
        }
        
        async function runAllTests() {
            clearResults();
            addResult('Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'info', 'Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...');
            
            await testFrontendConnection();
            await testServerConnection();
            await testDatabaseConnection();
            await testAuthentication();
            await testProductsAPI();
            await testCategoriesAPI();
            await testCouponsAPI();
            await testOrdersAPI();
            
            addResult('Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª', 'success', 'ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª');
        }
        
        // Auto-run basic tests on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                addResult('Ù…Ø±Ø­Ø¨Ø§Ù‹', 'info', 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØµÙØ­Ø© ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¯Ø§Ø´ Ø¨ÙˆØ±Ø¯');
                runAllTests();
            }, 500);
        });
    </script>
</body>
</html> 